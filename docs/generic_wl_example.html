<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HEBench: Generic Workload Example</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">HEBench
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('generic_wl_example.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Generic Workload Example </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md106">Problem Statement</a></li>
<li class="level1"><a href="#autotoc_md107">Example Configuration</a><ul><li class="level2"><a href="#autotoc_md108">Configuration for input InputParam[0]</a></li>
<li class="level2"><a href="#autotoc_md109">Configuration for input InputParam[1]</a></li>
<li class="level2"><a href="#autotoc_md110">Workload parameters</a></li>
<li class="level2"><a href="#autotoc_md111">Benchmark Configuration File</a></li>
</ul>
</li>
<li class="level1"><a href="#autotoc_md112">Example Dataset</a><ul><li class="level2"><a href="#autotoc_md113">Samples for InputParam[0]</a></li>
<li class="level2"><a href="#autotoc_md114">Samples for InputParam[1]</a></li>
<li class="level2"><a href="#autotoc_md115">Full dataset as must be provided to Test Harness</a></li>
</ul>
</li>
<li class="level1"><a href="#autotoc_md116">Example Backend</a></li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="md_docsrc_examples_generic_wl_example_generic_wl_example"></a></p>
<p>The <em>Generic Workload</em> is intended as a shortcut to help test and benchmark operations that are not directly supported by HEBench. See <a class="el" href="generic_workload.html">Generic Workload</a> for the full definition and reference. The nomenclature defined there is the same one used for the rest of this document.</p>
<p>Here is included an example on how to create a backend to benchmark a custom workload, and how to prepare configuration and dataset files for it.</p>
<h1><a class="anchor" id="autotoc_md106"></a>
Problem Statement</h1>
<p>Let's assume that the function we want to benchmark maps <code>(InputParam[0], InputParam[1])</code> to <code>(ResultComponent[0], ResultComponent[1], ResultComponent[2])</code> where <code>InputParam[0]</code> is a vector with two components, <code>InputParam[1]</code> is a vector with two components as well and:</p>
<div class="fragment"><div class="line">ResultComponent[0] = InputParam[0] + InputParam[1]</div>
<div class="line">ResultComponent[1] = InputParam[0] - InputParam[1]</div>
<div class="line">ResultComponent[2] = InputParam[0] . InputParam[1] <span class="comment">// dot product</span></div>
</div><!-- fragment --><p>Such operation is not supported by the standard workloads defined by HEBench, so, we need a generic workload to measure the performance of our backend implementation.</p>
<p>Let's also assume that we want to test in <em>offline</em> category using a dataset with <code>2</code> samples for <code>InputParam[0]</code> and <code>5</code> samples for <code>InputParam[1]</code>, which makes for <code>2 x 5 = 10</code> possible combinations of input samples.</p>
<h1><a class="anchor" id="autotoc_md107"></a>
Example Configuration</h1>
<p>These are the values that would be set in the <a class="el" href="config_file_reference.html">benchmark yaml configuration file</a>.</p>
<h2><a class="anchor" id="autotoc_md108"></a>
Configuration for input InputParam[0]</h2>
<ul>
<li>Number of samples: <code>2</code></li>
</ul>
<h2><a class="anchor" id="autotoc_md109"></a>
Configuration for input InputParam[1]</h2>
<ul>
<li>Number of samples: <code>5</code></li>
</ul>
<h2><a class="anchor" id="autotoc_md110"></a>
Workload parameters</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Index   </th><th class="markdownTableHeadNone">Name   </th><th class="markdownTableHeadNone">Type   </th><th class="markdownTableHeadNone">Value    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>0</code>   </td><td class="markdownTableBodyNone"><code>n</code>   </td><td class="markdownTableBodyNone"><code>uint64_t</code>   </td><td class="markdownTableBodyNone"><code>2</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>1</code>   </td><td class="markdownTableBodyNone"><code>m</code>   </td><td class="markdownTableBodyNone"><code>uint64_t</code>   </td><td class="markdownTableBodyNone"><code>3</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>2</code>   </td><td class="markdownTableBodyNone"><code>length_InputParam0</code>   </td><td class="markdownTableBodyNone"><code>uint64_t</code>   </td><td class="markdownTableBodyNone"><code>2</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>3</code>   </td><td class="markdownTableBodyNone"><code>length_InputParam1</code>   </td><td class="markdownTableBodyNone"><code>uint64_t</code>   </td><td class="markdownTableBodyNone"><code>2</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>4</code>   </td><td class="markdownTableBodyNone"><code>length_ResultComponent0</code>   </td><td class="markdownTableBodyNone"><code>uint64_t</code>   </td><td class="markdownTableBodyNone"><code>2</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>5</code>   </td><td class="markdownTableBodyNone"><code>length_ResultComponent1</code>   </td><td class="markdownTableBodyNone"><code>uint64_t</code>   </td><td class="markdownTableBodyNone"><code>2</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>6</code>   </td><td class="markdownTableBodyNone"><code>length_ResultComponent2</code>   </td><td class="markdownTableBodyNone"><code>uint64_t</code>   </td><td class="markdownTableBodyNone"><code>1</code>   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md111"></a>
Benchmark Configuration File</h2>
<p>The configuration given above translates to the following configuration file:</p>
<p><a class="el" href="generic_wl_config_yaml.html">config.yaml</a></p>
<h1><a class="anchor" id="autotoc_md112"></a>
Example Dataset</h1>
<p>For validation purposes, we must provide a dataset with our inputs and the expected output of the operation function evaluated on each input sample. The dataset must be provided in one of the dataset formats as supported by the <a class="el" href="dataset_loader_overview.html">dataset loader</a>.</p>
<h2><a class="anchor" id="autotoc_md113"></a>
Samples for InputParam[0]</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Sample   </th><th class="markdownTableHeadNone">Value    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone"><code>(1, 2)</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">1   </td><td class="markdownTableBodyNone"><code>(-1, -1)</code>   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md114"></a>
Samples for InputParam[1]</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Sample   </th><th class="markdownTableHeadNone">Value    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone"><code>(-1, 0)</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">1   </td><td class="markdownTableBodyNone"><code>(1, 1)</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">2   </td><td class="markdownTableBodyNone"><code>(2, -1)</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">2   </td><td class="markdownTableBodyNone"><code>(-2, 1)</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">2   </td><td class="markdownTableBodyNone"><code>(1, -1)</code>   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md115"></a>
Full dataset as must be provided to Test Harness</h2>
<p>Note in the following table that the order of combinations for input samples to Test Harness is defined to be row major; this is, the index for the most significant operation parameter moves faster when computing the position of an input sample in the ordering. For full definition see <a class="el" href="results_order.html">Ordering of Results Based on Input Batch Sizes</a> .</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Sample   </th><th class="markdownTableHeadNone">Inputs   </th><th class="markdownTableHeadNone"></th><th class="markdownTableHeadNone">Outputs   </th><th class="markdownTableHeadNone"></th><th class="markdownTableHeadNone"></th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"><code>InputParam[0]</code>   </td><td class="markdownTableBodyNone"><code>InputParam[1]</code>   </td><td class="markdownTableBodyNone"><code>ResultComponent[0]</code>   </td><td class="markdownTableBodyNone"><code>ResultComponent[1]</code>   </td><td class="markdownTableBodyNone"><code>ResultComponent[2]</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>0</code>   </td><td class="markdownTableBodyNone"><code>(1, 2)</code>   </td><td class="markdownTableBodyNone"><code>(-1, 0)</code>   </td><td class="markdownTableBodyNone"><code>(0, 2)</code>   </td><td class="markdownTableBodyNone"><code>(2, 2)</code>   </td><td class="markdownTableBodyNone"><code>(-1)</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>1</code>   </td><td class="markdownTableBodyNone"><code>(1, 2)</code>   </td><td class="markdownTableBodyNone"><code>(1, 1)</code>   </td><td class="markdownTableBodyNone"><code>(2, 3)</code>   </td><td class="markdownTableBodyNone"><code>(0, 1)</code>   </td><td class="markdownTableBodyNone"><code>(3)</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>2</code>   </td><td class="markdownTableBodyNone"><code>(1, 2)</code>   </td><td class="markdownTableBodyNone"><code>(2, -1)</code>   </td><td class="markdownTableBodyNone"><code>(3, 1)</code>   </td><td class="markdownTableBodyNone"><code>(-1, 3)</code>   </td><td class="markdownTableBodyNone"><code>(0)</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>3</code>   </td><td class="markdownTableBodyNone"><code>(1, 2)</code>   </td><td class="markdownTableBodyNone"><code>(-2, 1)</code>   </td><td class="markdownTableBodyNone"><code>(-1, 3)</code>   </td><td class="markdownTableBodyNone"><code>(3, 1)</code>   </td><td class="markdownTableBodyNone"><code>(0)</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>4</code>   </td><td class="markdownTableBodyNone"><code>(1, 2)</code>   </td><td class="markdownTableBodyNone"><code>(1, -1)</code>   </td><td class="markdownTableBodyNone"><code>(2, 1)</code>   </td><td class="markdownTableBodyNone"><code>(0, 3)</code>   </td><td class="markdownTableBodyNone"><code>(-1)</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>5</code>   </td><td class="markdownTableBodyNone"><code>(-1, -1)</code>   </td><td class="markdownTableBodyNone"><code>(-1, 0)</code>   </td><td class="markdownTableBodyNone"><code>(-2, -1)</code>   </td><td class="markdownTableBodyNone"><code>(0, -1)</code>   </td><td class="markdownTableBodyNone"><code>(1)</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>6</code>   </td><td class="markdownTableBodyNone"><code>(-1, -1)</code>   </td><td class="markdownTableBodyNone"><code>(1, 1)</code>   </td><td class="markdownTableBodyNone"><code>(0, 0)</code>   </td><td class="markdownTableBodyNone"><code>(-2, -2)</code>   </td><td class="markdownTableBodyNone"><code>(-2)</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>7</code>   </td><td class="markdownTableBodyNone"><code>(-1, -1)</code>   </td><td class="markdownTableBodyNone"><code>(2, -1)</code>   </td><td class="markdownTableBodyNone"><code>(1, -2)</code>   </td><td class="markdownTableBodyNone"><code>(-3, 0)</code>   </td><td class="markdownTableBodyNone"><code>(-1)</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>8</code>   </td><td class="markdownTableBodyNone"><code>(-1, -1)</code>   </td><td class="markdownTableBodyNone"><code>(-2, 1)</code>   </td><td class="markdownTableBodyNone"><code>(-3, 0)</code>   </td><td class="markdownTableBodyNone"><code>(1, -2)</code>   </td><td class="markdownTableBodyNone"><code>(1)</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>9</code>   </td><td class="markdownTableBodyNone"><code>(-1, -1)</code>   </td><td class="markdownTableBodyNone"><code>(1, -1)</code>   </td><td class="markdownTableBodyNone"><code>(0, -2)</code>   </td><td class="markdownTableBodyNone"><code>(-2, 0)</code>   </td><td class="markdownTableBodyNone"><code>(0)</code>   </td></tr>
</table>
<p>This dataset can be formatted into a CSV compatible with Test Harness's external dataset loader as follows:</p>
<p><a class="el" href="generic_wl_dataset_csv.html">dataset.csv</a></p>
<h1><a class="anchor" id="autotoc_md116"></a>
Example Backend</h1>
<p>These files implement an example backend that performs our custom operation in clear text using a Generic Workload as explained.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Example File   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="generic_wl_config_yaml.html">config.yaml</a>   </td><td class="markdownTableBodyNone">Generic workload example backend benchmark configuration.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="generic_wl_dataset_csv.html">dataset.csv</a>   </td><td class="markdownTableBodyNone">Generic workload example dataset in CSV.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="generic_wl_cmakelists.html">CMakeLists.txt</a>   </td><td class="markdownTableBodyNone">Generic workload example backend CMakeLists.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="generic__wl__engine_8h.html">generic_wl_engine.h</a>   </td><td class="markdownTableBodyNone">Generic workload engine header.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="generic__wl__engine_8cpp.html">generic_wl_engine.cpp</a>   </td><td class="markdownTableBodyNone">Generic workload engine implementation.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="generic__wl__benchmark_8h.html">generic_wl_benchmark.h</a>   </td><td class="markdownTableBodyNone">Generic workload backend benchmark header.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="generic__wl__benchmark_8cpp.html">generic_wl_benchmark.cpp</a>   </td><td class="markdownTableBodyNone">Generic workload backend benchmark implementation.   </td></tr>
</table>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
