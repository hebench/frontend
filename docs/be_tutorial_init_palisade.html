<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HEBench: Quickstart C++ Wrapper Backend Tutorial - Engine Initialization and Benchmark Description</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">HEBench
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('be_tutorial_init_palisade.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Quickstart C++ Wrapper Backend Tutorial - Engine Initialization and Benchmark Description </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md49">Steps</a><ul><li class="level2"><a href="#autotoc_md50">1. Benchmark description initialization</a></li>
<li class="level2"><a href="#autotoc_md51">2. Benchmark description overrides</a></li>
<li class="level2"><a href="#autotoc_md52">3. Engine initialization</a></li>
</ul>
</li>
<li class="level1"><a href="#autotoc_md53">Tutorial steps</a></li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="md_docsrc_examples_backend_tutorials_palisade_backend_tutorial_init_palisade"></a></p>
<h1><a class="anchor" id="autotoc_md49"></a>
Steps</h1>
<h2><a class="anchor" id="autotoc_md50"></a>
1. Benchmark description initialization</h2>
<p>The first step for our new benchmark is to fill out the benchmark description. <code>TutorialEltwiseAddBenchmarkDescription</code> defined in <code><a class="el" href="tutorial__eltwiseadd__benchmark__palisade_8h.html">tutorial_eltwiseadd_benchmark_palisade.h</a></code> inherits from <code><a class="el" href="classhebench_1_1cpp_1_1BenchmarkDescription.html" title="Base class for objects representing a specific benchmark based on an HEBench benchmark descriptor.">hebench::cpp::BenchmarkDescription</a></code>.</p>
<p>In the constructor we should initialize and set the inherited <code>m_descriptor</code> object. We currently have a description already in place from the original example to which we will make some changes for our PALISADE-based workload.</p>
<p><code>TutorialEltwiseAddBenchmarkDescription</code> is declared in <code><a class="el" href="tutorial__eltwiseadd__benchmark__palisade_8cpp.html">tutorial_eltwiseadd_benchmark_palisade.cpp</a></code>.</p>
<p>First, we initialize the descriptor object memory:</p>
<div class="fragment"><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="comment">// initialize the descriptor for this benchmark</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    std::memset(&amp;m_descriptor, 0, <span class="keyword">sizeof</span>(<a class="code" href="namespacehebench_1_1APIBridge.html#structhebench_1_1APIBridge_1_1BenchmarkDescriptor">hebench::APIBridge::BenchmarkDescriptor</a>));</div>
<div class="ttc" id="anamespacehebench_1_1APIBridge_html_structhebench_1_1APIBridge_1_1BenchmarkDescriptor"><div class="ttname"><a href="namespacehebench_1_1APIBridge.html#structhebench_1_1APIBridge_1_1BenchmarkDescriptor">hebench::APIBridge::BenchmarkDescriptor</a></div><div class="ttdoc">Defines a benchmark test.</div><div class="ttdef"><b>Definition:</b> <a href="types_8h_source.html#l00526">types.h:527</a></div></div>
</div><!-- fragment --><p> <b><a class="el" href="namespacehebench_1_1APIBridge.html#adb5a0a3dd5db924569d015849a543fa9" title="Workload for the benchmark.">hebench::APIBridge::BenchmarkDescriptor.workload</a></b>: specifies which workload this benchmark will perform. Workloads supported by your current HEBench version are defined under <code><a class="el" href="namespacehebench_1_1APIBridge.html#aeb7e1cd988a3ca98e5345d5bc90aa733" title="Defines all possible workloads.">hebench::APIBridge::Workload</a></code> in <code>hebench/api_bridge/types_palisade.h</code>. For our example we will set it to <code>hebench::APIBridge::Workload::EltwiseAdd</code>:</p>
<div class="fragment"><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    m_descriptor.workload = <a class="code" href="namespacehebench_1_1cpp_1_1WorkloadParams.html#a79b1a5a359871cd28f1b9608a866831a">hebench::APIBridge::Workload::EltwiseAdd</a>;</div>
<div class="ttc" id="anamespacehebench_1_1cpp_1_1WorkloadParams_html_a79b1a5a359871cd28f1b9608a866831a"><div class="ttname"><a href="namespacehebench_1_1cpp_1_1WorkloadParams.html#a79b1a5a359871cd28f1b9608a866831a">hebench::cpp::WorkloadParams::EltwiseAdd</a></div><div class="ttdeci">VectorSize EltwiseAdd</div><div class="ttdef"><b>Definition:</b> <a href="workload__params_8hpp_source.html#l00625">workload_params.hpp:625</a></div></div>
</div><!-- fragment --><p> <b><a class="el" href="namespacehebench_1_1APIBridge.html#a579a1cc22bb430f1ff2907a704dad1ba" title="Data type for the workload.">hebench::APIBridge::BenchmarkDescriptor.data_type</a></b>: tells the front end what type of data the benchmark is expecting to recieve and return. The possible types are defined in <code><a class="el" href="namespacehebench_1_1APIBridge.html#a29da34e3db6e0aadc9d1717a12d148ff" title="Defines data types for a workload.">hebench::APIBridge::DataType</a></code>.</p>
<div class="fragment"><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    m_descriptor.data_type = <a class="code" href="namespacehebench_1_1APIBridge_1_1WorkloadParamType.html#a58efab5fc8c4b9947767b255cee40cc6a20d47c01824eb3a053e626adf45f3a0e">hebench::APIBridge::DataType::Int64</a>;</div>
<div class="ttc" id="anamespacehebench_1_1APIBridge_1_1WorkloadParamType_html_a58efab5fc8c4b9947767b255cee40cc6a20d47c01824eb3a053e626adf45f3a0e"><div class="ttname"><a href="namespacehebench_1_1APIBridge_1_1WorkloadParamType.html#a58efab5fc8c4b9947767b255cee40cc6a20d47c01824eb3a053e626adf45f3a0e">hebench::APIBridge::WorkloadParamType::Int64</a></div><div class="ttdeci">@ Int64</div><div class="ttdoc">64 bits signed integers.</div><div class="ttdef"><b>Definition:</b> <a href="types_8h_source.html#l00304">types.h:304</a></div></div>
</div><!-- fragment --><p> <b><a class="el" href="namespacehebench_1_1APIBridge.html#abfb419d4396a03c0a062f4f8f600cb05" title="Category for the benchmark.">hebench::APIBridge::BenchmarkDescriptor.category</a></b>: Specifies one of the benchmark categories defined under <code><a class="el" href="namespacehebench_1_1APIBridge.html#a342c85b5dfa15ef7f8189791d1931653" title="Defines all possible categories for each workload.">hebench::APIBridge::Category</a></code>. For our first benchmark we are setting it to <b>offline</b>.</p>
<div class="fragment"><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    m_descriptor.category = <a class="code" href="namespacehebench_1_1APIBridge.html#a342c85b5dfa15ef7f8189791d1931653adc6bcebb0fd84672c6ece08d096e774c">hebench::APIBridge::Category::Offline</a>;</div>
<div class="ttc" id="anamespacehebench_1_1APIBridge_html_a342c85b5dfa15ef7f8189791d1931653adc6bcebb0fd84672c6ece08d096e774c"><div class="ttname"><a href="namespacehebench_1_1APIBridge.html#a342c85b5dfa15ef7f8189791d1931653adc6bcebb0fd84672c6ece08d096e774c">hebench::APIBridge::Offline</a></div><div class="ttdeci">@ Offline</div><div class="ttdef"><b>Definition:</b> <a href="types_8h_source.html#l00399">types.h:398</a></div></div>
</div><!-- fragment --><p> <b>hebench::APIBridge::BenchmarkDescriptor.cat_params.offline</b>: These are parameters which are relevant to tests of the offline category. These specify the supported number of samples (or batch sizes) for each of the operation parameters. These are arbitrary and specific to the benchmark we want to create. See the documentation for more details.</p>
<p>Since our initial workflow forced sample sizes of <code>2</code> samples for the first operand and <code>5</code> for the second, we are setting them the same here. If our benchmark can support variable sample sizes for any operand, we set the corresponding value to <code>0</code>. The specific size can be set in a configuration file passed when running this benchmark. For more information regarding benchmark configuration files see <a class="el" href="config_file_reference.html">Benchmark Configuration File Reference</a> .</p>
<div class="fragment"><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    m_descriptor.cat_params.offline.data_count[0] = 2; <span class="comment">// 2 data samples for op parameter 0</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    m_descriptor.cat_params.offline.data_count[1] = 5; <span class="comment">// 5 data samples for op parameter 1</span></div>
</div><!-- fragment --><p> <b><a class="el" href="namespacehebench_1_1APIBridge.html#a5677c168ed3969f08633b71d1e74791e" title="Input mask to define which operation parameters for the computation are plain text or cipher text.">hebench::APIBridge::BenchmarkDescriptor.cipher_param_mask</a></b>: Specifies which operands will be plain text and which will be encrypted. This is a bit mask where the bit position represents the operation parameter, and its value represents whether it is plain text (<code>0</code>) or encrypted (<code>1</code>). For this tutorial we want first operand plain text and second encrypted.</p>
<div class="fragment"><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    m_descriptor.cipher_param_mask = 1 &lt;&lt; 1;</div>
</div><!-- fragment --><p> Note that we are setting the mask to <code>1 &lt;&lt; 1</code> or <code>0000 0010</code> in binary, indicating that operation parameter in position <code>0</code> is plain text, and postion <code>1</code> is encrypted. The rest of the bits are ignored if there are not corresponding operation parameters.</p>
<p><b><a class="el" href="namespacehebench_1_1APIBridge.html#adbf6f8256f2beb8da1ba09591748a828" title="Scheme for the benchmark.">hebench::APIBridge::BenchmarkDescriptor.scheme</a></b>: Specifies the scheme the test will use. It must be one of the schemes registered during engine initialization earlier.</p>
<div class="fragment"><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    m_descriptor.scheme = <a class="code" href="types_8h.html#ad9302b3d3ffe3ce7a20cdd373b048d0f">HEBENCH_HE_SCHEME_BFV</a>;</div>
<div class="ttc" id="atypes_8h_html_ad9302b3d3ffe3ce7a20cdd373b048d0f"><div class="ttname"><a href="types_8h.html#ad9302b3d3ffe3ce7a20cdd373b048d0f">HEBENCH_HE_SCHEME_BFV</a></div><div class="ttdeci">#define HEBENCH_HE_SCHEME_BFV</div><div class="ttdef"><b>Definition:</b> <a href="types_8h_source.html#l00069">types.h:69</a></div></div>
</div><!-- fragment --><p> <b><a class="el" href="namespacehebench_1_1APIBridge.html#a05c7335c7cb7351f3ade8dbc8d257a9c" title="Security for the scheme.">hebench::APIBridge::BenchmarkDescriptor.security</a></b>: Specifies what security level the benchmark uses. It must be one of the security levels registered during engine initialization earlier.</p>
<div class="fragment"><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    m_descriptor.security = TUTORIAL_HE_SECURITY_128;</div>
</div><!-- fragment --><p> <b><a class="el" href="namespacehebench_1_1APIBridge.html#aa6647b59309c858def2e34ab3feaeda2" title="Backend specific extra parameter.">hebench::APIBridge::BenchmarkDescriptor.other</a></b>: This is an optional parameter which can be used for a backend defined purpose to differentiate benchmarks in additional backend-specific ways.</p>
<div class="fragment"><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    m_descriptor.other = 0; <span class="comment">// no extras needed for our purpose:</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        <span class="comment">// Other backends can use this field to differentiate between</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        <span class="comment">// benchmarks for which internal parameters, not specified by</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        <span class="comment">// other fields of this structure, differ.</span></div>
</div><!-- fragment --><p> Finally, a workload that requires flexible workload parameters must specify, at least, one set of default arguments. Workload parameters are flexible enough for backends to specify other parameters beyond the mandatory requirements, such as, but not limited to parameters that could be used for optimization like padding size, extra memory, etc.</p>
<p>According to <a class="el" href="elementwise_add.html">Vector Element-wise Addition Workload</a> , element-wise addition requires the number of elements for a vector. For this tutorial, the required parameter is enough, so, we do not need to create any extra workload parameters.</p>
<p>We create a single default set with a default value for the vector size:</p>
<div class="fragment"><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="comment">// specify default arguments for this workload flexible parameters:</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <a class="code" href="classhebench_1_1cpp_1_1WorkloadParams_1_1VectorSize.html">hebench::cpp::WorkloadParams::EltwiseAdd</a> default_workload_params;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    default_workload_params.<a class="code" href="classhebench_1_1cpp_1_1WorkloadParams_1_1VectorSize.html#af0ef1522a1d4dfe986249e1f34163711">n</a>() = 400;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    this-&gt;addDefaultParameters(default_workload_params);</div>
<div class="ttc" id="aclasshebench_1_1cpp_1_1WorkloadParams_1_1VectorSize_html"><div class="ttname"><a href="classhebench_1_1cpp_1_1WorkloadParams_1_1VectorSize.html">hebench::cpp::WorkloadParams::VectorSize</a></div><div class="ttdef"><b>Definition:</b> <a href="workload__params_8hpp_source.html#l00309">workload_params.hpp:310</a></div></div>
<div class="ttc" id="aclasshebench_1_1cpp_1_1WorkloadParams_1_1VectorSize_html_af0ef1522a1d4dfe986249e1f34163711"><div class="ttname"><a href="classhebench_1_1cpp_1_1WorkloadParams_1_1VectorSize.html#af0ef1522a1d4dfe986249e1f34163711">hebench::cpp::WorkloadParams::VectorSize::n</a></div><div class="ttdeci">std::uint64_t n() const</div><div class="ttdoc">Number elements in a vector.</div><div class="ttdef"><b>Definition:</b> <a href="workload__params_8hpp_source.html#l00321">workload_params.hpp:321</a></div></div>
</div><!-- fragment --><p> Since the value in our original workload was <code>400</code>, we are setting it the same as default. If our implementation happens to support only vectors of this size, we can enforce it during benchmark initialization itself.</p>
<p>The complete implementation of our Benchmark description is provided below </p><div class="fragment"><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;TutorialEltwiseAddBenchmarkDescription::TutorialEltwiseAddBenchmarkDescription()</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;{</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="comment">// initialize the descriptor for this benchmark</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    std::memset(&amp;m_descriptor, 0, <span class="keyword">sizeof</span>(<a class="code" href="namespacehebench_1_1APIBridge.html#structhebench_1_1APIBridge_1_1BenchmarkDescriptor">hebench::APIBridge::BenchmarkDescriptor</a>));</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160; </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    m_descriptor.workload = <a class="code" href="namespacehebench_1_1cpp_1_1WorkloadParams.html#a79b1a5a359871cd28f1b9608a866831a">hebench::APIBridge::Workload::EltwiseAdd</a>;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160; </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    m_descriptor.data_type = <a class="code" href="namespacehebench_1_1APIBridge_1_1WorkloadParamType.html#a58efab5fc8c4b9947767b255cee40cc6a20d47c01824eb3a053e626adf45f3a0e">hebench::APIBridge::DataType::Int64</a>;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160; </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    m_descriptor.category = <a class="code" href="namespacehebench_1_1APIBridge.html#a342c85b5dfa15ef7f8189791d1931653adc6bcebb0fd84672c6ece08d096e774c">hebench::APIBridge::Category::Offline</a>;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160; </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    m_descriptor.cat_params.offline.data_count[0] = 2; <span class="comment">// 2 data samples for op parameter 0</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    m_descriptor.cat_params.offline.data_count[1] = 5; <span class="comment">// 5 data samples for op parameter 1</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    m_descriptor.cipher_param_mask = 1 &lt;&lt; 1;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment"></span>    m_descriptor.scheme = <a class="code" href="types_8h.html#ad9302b3d3ffe3ce7a20cdd373b048d0f">HEBENCH_HE_SCHEME_BFV</a>;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160; </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    m_descriptor.security = TUTORIAL_HE_SECURITY_128;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    m_descriptor.other = 0; <span class="comment">// no extras needed for our purpose:</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        <span class="comment">// Other backends can use this field to differentiate between</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        <span class="comment">// benchmarks for which internal parameters, not specified by</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        <span class="comment">// other fields of this structure, differ.</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="comment">// specify default arguments for this workload flexible parameters:</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <a class="code" href="classhebench_1_1cpp_1_1WorkloadParams_1_1VectorSize.html">hebench::cpp::WorkloadParams::EltwiseAdd</a> default_workload_params;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    default_workload_params.<a class="code" href="classhebench_1_1cpp_1_1WorkloadParams_1_1VectorSize.html#af0ef1522a1d4dfe986249e1f34163711">n</a>() = 400;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    this-&gt;addDefaultParameters(default_workload_params);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;}</div>
</div><!-- fragment --> <h2><a class="anchor" id="autotoc_md51"></a>
2. Benchmark description overrides</h2>
<p>We must override methods to create and destroy our actual benchmark. These will be called by C++ wrapper's BaseEngine implementation when the benchmark needs to be instantiated to execute, and disposed of when completed.</p>
<p>Our create method follows:</p>
<div class="fragment"><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<a class="code" href="classhebench_1_1cpp_1_1BaseBenchmark.html">hebench::cpp::BaseBenchmark</a> *<a class="code" href="namespacehebench_1_1APIBridge.html#a7b0808f5d5a29d8c332313038ab44b94">TutorialEltwiseAddBenchmarkDescription::createBenchmark</a>(<a class="code" href="classhebench_1_1cpp_1_1BaseEngine.html">hebench::cpp::BaseEngine</a> &amp;engine,</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                                                                                     <span class="keyword">const</span> <a class="code" href="namespacehebench_1_1APIBridge.html#structhebench_1_1APIBridge_1_1WorkloadParams">hebench::APIBridge::WorkloadParams</a> *p_params)</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;{</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="keywordflow">if</span> (!p_params)</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classhebench_1_1cpp_1_1HEBenchError.html">hebench::cpp::HEBenchError</a>(<a class="code" href="error__handling_8hpp.html#a9d8a8027ac0dfd443d0b8d000f86c30d">HEBERROR_MSG_CLASS</a>(<span class="stringliteral">&quot;Invalid empty workload parameters. This workload requires flexible parameters.&quot;</span>),</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                                         <a class="code" href="types_8h.html#ad82634ee6ea94a7dfb5e24b89afbaaa1">HEBENCH_ECODE_CRITICAL_ERROR</a>);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160; </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    TutorialEngine &amp;ex_engine = <span class="keyword">dynamic_cast&lt;</span>TutorialEngine &amp;<span class="keyword">&gt;</span>(engine);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">new</span> TutorialEltwiseAddBenchmark(ex_engine, m_descriptor, *p_params);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;}</div>
<div class="ttc" id="aclasshebench_1_1cpp_1_1BaseBenchmark_html"><div class="ttname"><a href="classhebench_1_1cpp_1_1BaseBenchmark.html">hebench::cpp::BaseBenchmark</a></div><div class="ttdoc">Top level opaque benchmark class.</div><div class="ttdef"><b>Definition:</b> <a href="benchmark_8hpp_source.html#l00142">benchmark.hpp:143</a></div></div>
<div class="ttc" id="aclasshebench_1_1cpp_1_1BaseEngine_html"><div class="ttname"><a href="classhebench_1_1cpp_1_1BaseEngine.html">hebench::cpp::BaseEngine</a></div><div class="ttdoc">Base class that encapsulates common behavior of backend engines.</div><div class="ttdef"><b>Definition:</b> <a href="engine_8hpp_source.html#l00069">engine.hpp:70</a></div></div>
<div class="ttc" id="aclasshebench_1_1cpp_1_1HEBenchError_html"><div class="ttname"><a href="classhebench_1_1cpp_1_1HEBenchError.html">hebench::cpp::HEBenchError</a></div><div class="ttdef"><b>Definition:</b> <a href="error__handling_8hpp_source.html#l00024">error_handling.hpp:25</a></div></div>
<div class="ttc" id="aerror__handling_8hpp_html_a9d8a8027ac0dfd443d0b8d000f86c30d"><div class="ttname"><a href="error__handling_8hpp.html#a9d8a8027ac0dfd443d0b8d000f86c30d">HEBERROR_MSG_CLASS</a></div><div class="ttdeci">#define HEBERROR_MSG_CLASS(message)</div><div class="ttdef"><b>Definition:</b> <a href="error__handling_8hpp_source.html#l00016">error_handling.hpp:16</a></div></div>
<div class="ttc" id="anamespacehebench_1_1APIBridge_html_a7b0808f5d5a29d8c332313038ab44b94"><div class="ttname"><a href="namespacehebench_1_1APIBridge.html#a7b0808f5d5a29d8c332313038ab44b94">hebench::APIBridge::createBenchmark</a></div><div class="ttdeci">ErrorCode createBenchmark(Handle h_engine, Handle h_bench_desc, const WorkloadParams *p_params, Handle *h_benchmark)</div><div class="ttdoc">Instantiates a benchmark on the backend.</div></div>
<div class="ttc" id="anamespacehebench_1_1APIBridge_html_structhebench_1_1APIBridge_1_1WorkloadParams"><div class="ttname"><a href="namespacehebench_1_1APIBridge.html#structhebench_1_1APIBridge_1_1WorkloadParams">hebench::APIBridge::WorkloadParams</a></div><div class="ttdoc">Specifies the parameters for a workload.</div><div class="ttdef"><b>Definition:</b> <a href="types_8h_source.html#l00362">types.h:363</a></div></div>
<div class="ttc" id="atypes_8h_html_ad82634ee6ea94a7dfb5e24b89afbaaa1"><div class="ttname"><a href="types_8h.html#ad82634ee6ea94a7dfb5e24b89afbaaa1">HEBENCH_ECODE_CRITICAL_ERROR</a></div><div class="ttdeci">#define HEBENCH_ECODE_CRITICAL_ERROR</div><div class="ttdoc">Specifies a critical error.</div><div class="ttdef"><b>Definition:</b> <a href="types_8h_source.html#l00050">types.h:50</a></div></div>
</div><!-- fragment --><p> This is the destroy method:</p>
<div class="fragment"><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="keywordtype">void</span> TutorialEltwiseAddBenchmarkDescription::destroyBenchmark(<a class="code" href="classhebench_1_1cpp_1_1BaseBenchmark.html">hebench::cpp::BaseBenchmark</a> *p_bench)</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;{</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="keywordflow">if</span> (p_bench)</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        <span class="keyword">delete</span> p_bench;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;}</div>
</div><!-- fragment --><p> There are other methods that we can override to modify the behavior of the description class. Check the documentation on <code><a class="el" href="classhebench_1_1cpp_1_1BenchmarkDescription.html" title="Base class for objects representing a specific benchmark based on an HEBench benchmark descriptor.">hebench::cpp::BenchmarkDescription</a></code> for more information.</p>
<p>In this tutorial we are overriding <code><a class="el" href="classhebench_1_1cpp_1_1BenchmarkDescription.html#adb3f6dfbfa1bf3da9fd59a5059188645" title="Retrieves human-readable description specific to the represented benchmark.">hebench::cpp::BenchmarkDescription::getBenchmarkDescription()</a></code> to output extra information customized for our example.</p>
<div class="fragment"><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;std::string TutorialEltwiseAddBenchmarkDescription::getBenchmarkDescription(<span class="keyword">const</span> <a class="code" href="namespacehebench_1_1APIBridge.html#structhebench_1_1APIBridge_1_1WorkloadParams">hebench::APIBridge::WorkloadParams</a> *p_w_params)<span class="keyword"> const</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    std::stringstream ss;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    ss &lt;&lt; BenchmarkDescription::getBenchmarkDescription(p_w_params);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    ss &lt;&lt; <span class="stringliteral">&quot;, Encryption parameters&quot;</span> &lt;&lt; std::endl</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;       &lt;&lt; <span class="stringliteral">&quot;, , HE Library, PALISADE v1.11.3&quot;</span> &lt;&lt; std::endl</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;       &lt;&lt; <span class="stringliteral">&quot;, , Poly modulus degree, &quot;</span> &lt;&lt; PolyModulusDegree &lt;&lt; std::endl</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;       &lt;&lt; <span class="stringliteral">&quot;, , Coefficient Moduli, 60, 60&quot;</span>;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keywordflow">if</span> (p_w_params)</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    {</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <a class="code" href="classhebench_1_1cpp_1_1WorkloadParams_1_1VectorSize.html">hebench::cpp::WorkloadParams::EltwiseAdd</a> w_params(*p_w_params);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        ss &lt;&lt; std::endl</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;           &lt;&lt; <span class="stringliteral">&quot;, Workload parameters&quot;</span> &lt;&lt; std::endl</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;           &lt;&lt; <span class="stringliteral">&quot;, , n, &quot;</span> &lt;&lt; w_params.n();</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    } <span class="comment">// end if</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keywordflow">return</span> ss.str();</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;}</div>
</div><!-- fragment --> <h2><a class="anchor" id="autotoc_md52"></a>
3. Engine initialization</h2>
<p>At this point, we can start filling out new information for our specific benchmark inside the engine. This is required to make our benchmark visible to the Test Harness since the engine is responsible for managing the benchmarks' lifespans. First we are going to add options to the <code>TutorialEngine::init()</code> method which implements the <code><a class="el" href="classhebench_1_1cpp_1_1BaseEngine.html#a9a6e2e8517aa6474d106c8c7e916aac9" title="Initializes the backend engine and populates the backend description.">hebench::cpp::BaseEngine::init()</a></code> virtual method. The order of initialization in the next sections can be any.</p>
<p>Inside of <code>TutorialEngine::init()</code> we will see the following code already populated from our default example:</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> TutorialEngine::init()</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// add any new error codes: use</span></div>
<div class="line">    <span class="comment">// this-&gt;addErrorCode(code, &quot;generic description&quot;);</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// add supported schemes</span></div>
<div class="line">    addSchemeName(HEBENCH_HE_SCHEME_PLAIN, <span class="stringliteral">&quot;Plain&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// add supported security</span></div>
<div class="line">    addSecurityName(HEBENCH_HE_SECURITY_NONE, <span class="stringliteral">&quot;None&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// add the all benchmark descriptors</span></div>
<div class="line">    addBenchmarkDescription(std::make_shared&lt;TutorialEltwiseAddBenchmarkDescription&gt;());</div>
<div class="line">}</div>
</div><!-- fragment --><p>For this tutorial, we will make a few changes as we plan to perform our operations homomorphically.</p>
<p>First, we add any new error codes which we want our engine to be capable of returning back to the frontend. For our example we define one new error as shown below. These errors are defined inside of <code><a class="el" href="tutorial__error__palisade_8h.html">tutorial_error_palisade.h</a></code>.</p>
<div class="fragment"><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="comment">// add any new error codes</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    addErrorCode(TUTORIAL_ECODE_PALISADE_ERROR, <span class="stringliteral">&quot;PALISADE error.&quot;</span>);</div>
</div><!-- fragment --><p> Next, we add the scheme names we want to support. For our simple example we will just add BFV scheme which is predefined as part of <code><a class="el" href="namespacehebench_1_1APIBridge.html">hebench::APIBridge</a></code> namespace. Any other schemes can be custom defined as well.</p>
<div class="fragment"><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="comment">// add supported schemes</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="comment">//addSchemeName(HEBENCH_HE_SCHEME_PLAIN, &quot;Plain&quot;);</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    addSchemeName(<a class="code" href="types_8h.html#ad9302b3d3ffe3ce7a20cdd373b048d0f">HEBENCH_HE_SCHEME_BFV</a>, <span class="stringliteral">&quot;BFV&quot;</span>);</div>
</div><!-- fragment --><p> We then add our supported security levels. For our new backend we specify a flag for 128-bit security inside of <code><a class="el" href="tutorial__engine__palisade_8h.html">tutorial_engine_palisade.h</a></code> and then pass it here.</p>
<div class="fragment"><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="comment">// add supported security</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="comment">//addSecurityName(HEBENCH_HE_SECURITY_NONE, &quot;None&quot;);</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    addSecurityName(TUTORIAL_HE_SECURITY_128, <span class="stringliteral">&quot;128 bits&quot;</span>);</div>
</div><!-- fragment --><p> Last, in <code>init()</code> we add all of the supported benchmarks to the engine. For our example we will be adding just the single example benchmark but as we expand our backend and add more benchmarks, we would add them to this section in the same fashion as shown.</p>
<div class="fragment"><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="comment">// add the all benchmark descriptors</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    addBenchmarkDescription(std::make_shared&lt;TutorialEltwiseAddBenchmarkDescription&gt;());</div>
</div><!-- fragment --><p> The full code for our engine init function looks like this: </p><div class="fragment"><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="keywordtype">void</span> TutorialEngine::init()</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;{</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="comment">// add any new error codes</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    addErrorCode(TUTORIAL_ECODE_PALISADE_ERROR, <span class="stringliteral">&quot;PALISADE error.&quot;</span>);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="comment">// add supported schemes</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="comment">//addSchemeName(HEBENCH_HE_SCHEME_PLAIN, &quot;Plain&quot;);</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    addSchemeName(<a class="code" href="types_8h.html#ad9302b3d3ffe3ce7a20cdd373b048d0f">HEBENCH_HE_SCHEME_BFV</a>, <span class="stringliteral">&quot;BFV&quot;</span>);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="comment">// add supported security</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="comment">//addSecurityName(HEBENCH_HE_SECURITY_NONE, &quot;None&quot;);</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    addSecurityName(TUTORIAL_HE_SECURITY_128, <span class="stringliteral">&quot;128 bits&quot;</span>);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="comment">// add the all benchmark descriptors</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    addBenchmarkDescription(std::make_shared&lt;TutorialEltwiseAddBenchmarkDescription&gt;());</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;}</div>
</div><!-- fragment --> <h1><a class="anchor" id="autotoc_md53"></a>
Tutorial steps</h1>
<p><a class="el" href="simple_cpp_example_palisade.html#md_docsrc_examples_backend_tutorials_palisade_backend_tutorial_palisade">Tutorial Home</a><br  />
 <a class="el" href="be_tutorial_preparation_palisade.html#md_docsrc_examples_backend_tutorials_palisade_backend_tutorial_preparation_palisade">Preparation</a><br  />
 <b>Engine Initialization and Benchmark Description</b><br  />
 <a class="el" href="be_tutorial_impl_palisade.html#md_docsrc_examples_backend_tutorials_palisade_backend_tutorial_impl_palisade">Benchmark Implementation</a><br  />
 <a class="el" href="be_tutorial_files_palisade.html#md_docsrc_examples_backend_tutorials_palisade_backend_tutorial_files_palisade">File References</a> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
